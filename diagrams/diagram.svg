<svg xmlns="http://www.w3.org/2000/svg" width="1000" height="820" viewBox="0 0 1000 820" font-family="'Segoe UI', Arial, sans-serif">
  <defs>
    <!-- Background gradient -->
    <linearGradient id="bgGrad" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#0a0c10"/>
      <stop offset="100%" stop-color="#0d1117"/>
    </linearGradient>
    <!-- Accent gradients -->
    <linearGradient id="titleGrad" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#ffffff"/>
      <stop offset="100%" stop-color="#00e5a0"/>
    </linearGradient>
    <!-- Arrow marker -->
    <marker id="arrowGreen" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#00e5a0"/>
    </marker>
    <marker id="arrowYellow" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#ffd166"/>
    </marker>
    <marker id="arrowPurple" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#6c63ff"/>
    </marker>
    <!-- Grid pattern -->
    <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
      <path d="M 40 0 L 0 0 0 40" fill="none" stroke="#00e5a0" stroke-width="0.3" stroke-opacity="0.07"/>
    </pattern>
    <!-- Drop shadow -->
    <filter id="shadow">
      <feDropShadow dx="0" dy="4" stdDeviation="6" flood-color="#000" flood-opacity="0.5"/>
    </filter>
  </defs>

  <!-- BG -->
  <rect width="1000" height="820" fill="url(#bgGrad)"/>
  <rect width="1000" height="820" fill="url(#grid)"/>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- HEADER                                     -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <rect x="20" y="18" width="960" height="76" rx="10" fill="#111318" stroke="#2a2d3a" stroke-width="1"/>
  <rect x="20" y="18" width="960" height="3" rx="2" fill="#00e5a0"/>

  <!-- Badge -->
  <rect x="40" y="30" width="140" height="18" rx="3" fill="none" stroke="#00e5a0" stroke-opacity="0.35" stroke-width="1"/>
  <text x="110" y="43" text-anchor="middle" fill="#00e5a0" font-size="9" font-weight="600" letter-spacing="2">SYSTEM ARCHITECTURE</text>

  <text x="40" y="76" fill="white" font-size="22" font-weight="800" letter-spacing="-0.5">User Auth Service</text>
  <text x="290" y="76" fill="#00e5a0" font-size="22" font-weight="800">â€” Production-Grade Node.js Authentication</text>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- TECH PILLS                                 -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- Row 1 -->
  <g transform="translate(20, 106)">
    <!-- Node.js -->
    <rect x="0" y="0" width="108" height="20" rx="10" fill="#00e5a01a" stroke="#00e5a040" stroke-width="1"/>
    <text x="54" y="14" text-anchor="middle" fill="#00e5a0" font-size="10" font-weight="600">Node.js + Express</text>
    <!-- MongoDB -->
    <rect x="116" y="0" width="110" height="20" rx="10" fill="#ffd1661a" stroke="#ffd16640" stroke-width="1"/>
    <text x="171" y="14" text-anchor="middle" fill="#ffd166" font-size="10" font-weight="600">MongoDB + Mongoose</text>
    <!-- Redis -->
    <rect x="234" y="0" width="70" height="20" rx="10" fill="#ff6b6b1a" stroke="#ff6b6b40" stroke-width="1"/>
    <text x="269" y="14" text-anchor="middle" fill="#ff6b6b" font-size="10" font-weight="600">Redis</text>
    <!-- Kafka -->
    <rect x="312" y="0" width="76" height="20" rx="10" fill="#6c63ff1a" stroke="#6c63ff40" stroke-width="1"/>
    <text x="350" y="14" text-anchor="middle" fill="#6c63ff" font-size="10" font-weight="600">Kafka (SSL)</text>
    <!-- JWT -->
    <rect x="396" y="0" width="56" height="20" rx="10" fill="#00e5a01a" stroke="#00e5a040" stroke-width="1"/>
    <text x="424" y="14" text-anchor="middle" fill="#00e5a0" font-size="10" font-weight="600">JWT Auth</text>
    <!-- bcrypt -->
    <rect x="460" y="0" width="60" height="20" rx="10" fill="#00e5a01a" stroke="#00e5a040" stroke-width="1"/>
    <text x="490" y="14" text-anchor="middle" fill="#00e5a0" font-size="10" font-weight="600">bcryptjs</text>
    <!-- OTP -->
    <rect x="528" y="0" width="60" height="20" rx="10" fill="#ff6b6b1a" stroke="#ff6b6b40" stroke-width="1"/>
    <text x="558" y="14" text-anchor="middle" fill="#ff6b6b" font-size="10" font-weight="600">OTP Verify</text>
    <!-- Helmet -->
    <rect x="596" y="0" width="66" height="20" rx="10" fill="#00e5a01a" stroke="#00e5a040" stroke-width="1"/>
    <text x="629" y="14" text-anchor="middle" fill="#00e5a0" font-size="10" font-weight="600">Helmet+HPP</text>
    <!-- Swagger -->
    <rect x="670" y="0" width="80" height="20" rx="10" fill="#ffd1661a" stroke="#ffd16640" stroke-width="1"/>
    <text x="710" y="14" text-anchor="middle" fill="#ffd166" font-size="10" font-weight="600">Swagger/OpenAPI</text>
    <!-- Pino -->
    <rect x="758" y="0" width="60" height="20" rx="10" fill="#6c63ff1a" stroke="#6c63ff40" stroke-width="1"/>
    <text x="788" y="14" text-anchor="middle" fill="#6c63ff" font-size="10" font-weight="600">Pino Logger</text>
    <!-- Nodemailer -->
    <rect x="826" y="0" width="86" height="20" rx="10" fill="#ffd1661a" stroke="#ffd16640" stroke-width="1"/>
    <text x="869" y="14" text-anchor="middle" fill="#ffd166" font-size="10" font-weight="600">Nodemailer</text>
  </g>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- LAYER 1: CLIENT                            -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <text x="20" y="156" fill="#6b7280" font-size="9" letter-spacing="2" font-weight="600">01 â€” CLIENT</text>
  <line x1="140" y1="152" x2="980" y2="152" stroke="#2a2d3a" stroke-width="1"/>

  <rect x="20" y="162" width="960" height="40" rx="8" fill="#111318" stroke="#38bdf840" stroke-width="1" filter="url(#shadow)"/>
  <rect x="20" y="162" width="960" height="2" rx="2" fill="#38bdf8"/>
  <text x="50" y="186" fill="#38bdf8" font-size="16">ğŸŒ</text>
  <text x="75" y="185" fill="white" font-size="13" font-weight="700">Client Application</text>
  <text x="75" y="196" fill="#6b7280" font-size="10">Web / Mobile â€” REST API Consumer â€” HTTPS + Bearer Token</text>
  <rect x="880" y="170" width="88" height="16" rx="3" fill="#38bdf81a" stroke="#38bdf840" stroke-width="1"/>
  <text x="924" y="181" text-anchor="middle" fill="#38bdf8" font-size="9" font-weight="600">HTTPS + CORS</text>

  <!-- Arrow -->
  <line x1="500" y1="204" x2="500" y2="222" stroke="#00e5a0" stroke-width="1.5" marker-end="url(#arrowGreen)" stroke-dasharray="4 3"/>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- LAYER 2: SECURITY                          -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <text x="20" y="238" fill="#6b7280" font-size="9" letter-spacing="2" font-weight="600">02 â€” SECURITY &amp; MIDDLEWARE</text>
  <line x1="220" y1="234" x2="980" y2="234" stroke="#2a2d3a" stroke-width="1"/>

  <!-- 4 security nodes -->
  <!-- Rate Limit -->
  <rect x="20" y="244" width="228" height="52" rx="8" fill="#111318" stroke="#2a2d3a" stroke-width="1"/>
  <rect x="20" y="244" width="228" height="2" rx="2" fill="#00e5a0"/>
  <text x="44" y="266" fill="#00e5a0" font-size="15">ğŸ›¡ï¸</text>
  <text x="65" y="265" fill="white" font-size="12" font-weight="700">Rate Limiter</text>
  <text x="65" y="278" fill="#6b7280" font-size="10">100 req / 15 min Â· express-rate-limit</text>
  <rect x="24" y="282" width="58" height="10" rx="3" fill="#00e5a01a"/>
  <text x="53" y="290" text-anchor="middle" fill="#00e5a0" font-size="8" font-weight="600">GLOBAL</text>

  <!-- Helmet -->
  <rect x="258" y="244" width="228" height="52" rx="8" fill="#111318" stroke="#2a2d3a" stroke-width="1"/>
  <rect x="258" y="244" width="228" height="2" rx="2" fill="#00e5a0"/>
  <text x="280" y="266" fill="#00e5a0" font-size="15">ğŸª–</text>
  <text x="300" y="265" fill="white" font-size="12" font-weight="700">Helmet</text>
  <text x="300" y="278" fill="#6b7280" font-size="10">Security headers Â· CSP Â· XSS protection</text>
  <rect x="262" y="282" width="54" height="10" rx="3" fill="#00e5a01a"/>
  <text x="289" y="290" text-anchor="middle" fill="#00e5a0" font-size="8" font-weight="600">HEADERS</text>

  <!-- HPP + Sanitizer -->
  <rect x="496" y="244" width="228" height="52" rx="8" fill="#111318" stroke="#2a2d3a" stroke-width="1"/>
  <rect x="496" y="244" width="228" height="2" rx="2" fill="#00e5a0"/>
  <text x="518" y="266" fill="#00e5a0" font-size="15">ğŸ”’</text>
  <text x="540" y="265" fill="white" font-size="12" font-weight="700">HPP + Sanitizer</text>
  <text x="540" y="278" fill="#6b7280" font-size="10">Param pollution Â· XSS / NoSQL / SQL clean</text>
  <rect x="500" y="282" width="46" height="10" rx="3" fill="#00e5a01a"/>
  <text x="523" y="290" text-anchor="middle" fill="#00e5a0" font-size="8" font-weight="600">INPUT</text>

  <!-- CORS -->
  <rect x="734" y="244" width="246" height="52" rx="8" fill="#111318" stroke="#2a2d3a" stroke-width="1"/>
  <rect x="734" y="244" width="246" height="2" rx="2" fill="#00e5a0"/>
  <text x="756" y="266" fill="#00e5a0" font-size="15">ğŸŒ</text>
  <text x="778" y="265" fill="white" font-size="12" font-weight="700">CORS</text>
  <text x="778" y="278" fill="#6b7280" font-size="10">CLIENT_URL origin Â· Credentials allowed</text>
  <rect x="738" y="282" width="50" height="10" rx="3" fill="#00e5a01a"/>
  <text x="763" y="290" text-anchor="middle" fill="#00e5a0" font-size="8" font-weight="600">ORIGIN</text>

  <!-- Arrow -->
  <line x1="500" y1="298" x2="500" y2="316" stroke="#00e5a0" stroke-width="1.5" marker-end="url(#arrowGreen)" stroke-dasharray="4 3"/>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- LAYER 3: AUTH MIDDLEWARE + CONTROLLER      -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <text x="20" y="332" fill="#6b7280" font-size="9" letter-spacing="2" font-weight="600">03 â€” AUTH MIDDLEWARE + CONTROLLER</text>
  <line x1="290" y1="328" x2="980" y2="328" stroke="#2a2d3a" stroke-width="1"/>

  <!-- protect middleware -->
  <rect x="20" y="338" width="198" height="62" rx="8" fill="#111318" stroke="#6c63ff40" stroke-width="1"/>
  <rect x="20" y="338" width="198" height="2" rx="2" fill="#6c63ff"/>
  <text x="42" y="360" fill="#6c63ff" font-size="14">ğŸ”</text>
  <text x="60" y="359" fill="white" font-size="12" font-weight="700">Auth Middleware</text>
  <text x="25" y="375" fill="#6b7280" font-size="10">protect â€” verify Bearer JWT</text>
  <text x="25" y="388" fill="#6b7280" font-size="10">adminOnly â€” role check</text>
  <rect x="24" y="392" width="62" height="10" rx="3" fill="#6c63ff1a"/>
  <text x="55" y="400" text-anchor="middle" fill="#6c63ff" font-size="8" font-weight="600">JWT VERIFY</text>

  <!-- Auth Controller -->
  <rect x="228" y="338" width="210" height="62" rx="8" fill="#111318" stroke="#6c63ff40" stroke-width="1"/>
  <rect x="228" y="338" width="210" height="2" rx="2" fill="#6c63ff"/>
  <text x="250" y="360" fill="#6c63ff" font-size="14">ğŸ®</text>
  <text x="270" y="359" fill="white" font-size="12" font-weight="700">Auth Controller</text>
  <text x="233" y="375" fill="#6b7280" font-size="10">signup Â· verify Â· login Â· logout</text>
  <text x="233" y="388" fill="#6b7280" font-size="10">refresh Â· listUsers Â· update Â· remove</text>
  <rect x="232" y="392" width="76" height="10" rx="3" fill="#6c63ff1a"/>
  <text x="270" y="400" text-anchor="middle" fill="#6c63ff" font-size="8" font-weight="600">BUSINESS LOGIC</text>

  <!-- Token Util -->
  <rect x="448" y="338" width="162" height="62" rx="8" fill="#111318" stroke="#6c63ff40" stroke-width="1"/>
  <rect x="448" y="338" width="162" height="2" rx="2" fill="#6c63ff"/>
  <text x="468" y="360" fill="#6c63ff" font-size="14">ğŸª™</text>
  <text x="488" y="359" fill="white" font-size="12" font-weight="700">Token Utils</text>
  <text x="453" y="375" fill="#6b7280" font-size="10">Access JWT (short TTL)</text>
  <text x="453" y="388" fill="#6b7280" font-size="10">Refresh JWT (7 days)</text>
  <rect x="452" y="392" width="38" height="10" rx="3" fill="#6c63ff1a"/>
  <text x="471" y="400" text-anchor="middle" fill="#6c63ff" font-size="8" font-weight="600">JWT</text>

  <!-- OTP Util -->
  <rect x="620" y="338" width="162" height="62" rx="8" fill="#111318" stroke="#6c63ff40" stroke-width="1"/>
  <rect x="620" y="338" width="162" height="2" rx="2" fill="#6c63ff"/>
  <text x="640" y="360" fill="#6c63ff" font-size="14">ğŸ”¢</text>
  <text x="660" y="359" fill="white" font-size="12" font-weight="700">OTP Utils</text>
  <text x="625" y="375" fill="#6b7280" font-size="10">Generate + store in Redis</text>
  <text x="625" y="388" fill="#6b7280" font-size="10">Verify with TTL expiry</text>
  <rect x="624" y="392" width="60" height="10" rx="3" fill="#6c63ff1a"/>
  <text x="654" y="400" text-anchor="middle" fill="#6c63ff" font-size="8" font-weight="600">6-DIGIT OTP</text>

  <!-- Mail Util -->
  <rect x="792" y="338" width="188" height="62" rx="8" fill="#111318" stroke="#6c63ff40" stroke-width="1"/>
  <rect x="792" y="338" width="188" height="2" rx="2" fill="#6c63ff"/>
  <text x="812" y="360" fill="#6c63ff" font-size="14">ğŸ“¬</text>
  <text x="832" y="359" fill="white" font-size="12" font-weight="700">Mail Utils</text>
  <text x="797" y="375" fill="#6b7280" font-size="10">sendOTPEmail (direct SMTP)</text>
  <text x="797" y="388" fill="#6b7280" font-size="10">sendWelcomeEmail (Kafka)</text>
  <rect x="796" y="392" width="72" height="10" rx="3" fill="#6c63ff1a"/>
  <text x="832" y="400" text-anchor="middle" fill="#6c63ff" font-size="8" font-weight="600">NODEMAILER</text>

  <!-- Arrow -->
  <line x1="500" y1="402" x2="500" y2="420" stroke="#00e5a0" stroke-width="1.5" marker-end="url(#arrowGreen)" stroke-dasharray="4 3"/>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- LAYER 4: INFRASTRUCTURE                    -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <text x="20" y="436" fill="#6b7280" font-size="9" letter-spacing="2" font-weight="600">04 â€” INFRASTRUCTURE</text>
  <line x1="156" y1="432" x2="980" y2="432" stroke="#2a2d3a" stroke-width="1"/>

  <!-- MongoDB -->
  <rect x="20" y="442" width="228" height="68" rx="8" fill="#111318" stroke="#ffd16640" stroke-width="1" filter="url(#shadow)"/>
  <rect x="20" y="442" width="228" height="2" rx="2" fill="#ffd166"/>
  <text x="42" y="468" fill="#ffd166" font-size="18">ğŸƒ</text>
  <text x="68" y="466" fill="white" font-size="13" font-weight="700">MongoDB</text>
  <text x="25" y="480" fill="#6b7280" font-size="10">User schema Â· bcrypt passwords</text>
  <text x="25" y="492" fill="#6b7280" font-size="10">Auto-reconnect (max 5 retries)</text>
  <rect x="24" y="500" width="60" height="10" rx="3" fill="#ffd1661a"/>
  <text x="54" y="508" text-anchor="middle" fill="#ffd166" font-size="8" font-weight="600">MONGOOSE</text>

  <!-- Redis -->
  <rect x="258" y="442" width="228" height="68" rx="8" fill="#111318" stroke="#ff6b6b40" stroke-width="1" filter="url(#shadow)"/>
  <rect x="258" y="442" width="228" height="2" rx="2" fill="#ff6b6b"/>
  <text x="280" y="468" fill="#ff6b6b" font-size="18">âš¡</text>
  <text x="305" y="466" fill="white" font-size="13" font-weight="700">Redis</text>
  <text x="263" y="480" fill="#6b7280" font-size="10">Refresh tokens Â· OTP codes</text>
  <text x="263" y="492" fill="#6b7280" font-size="10">User list cache (TTL 180s)</text>
  <rect x="262" y="500" width="46" height="10" rx="3" fill="#ff6b6b1a"/>
  <text x="285" y="508" text-anchor="middle" fill="#ff6b6b" font-size="8" font-weight="600">IOREDIS</text>

  <!-- Kafka -->
  <rect x="496" y="442" width="228" height="68" rx="8" fill="#111318" stroke="#6c63ff40" stroke-width="1" filter="url(#shadow)"/>
  <rect x="496" y="442" width="228" height="2" rx="2" fill="#6c63ff"/>
  <text x="518" y="468" fill="#6c63ff" font-size="18">ğŸ”€</text>
  <text x="545" y="466" fill="white" font-size="13" font-weight="700">Kafka</text>
  <text x="501" y="480" fill="#6b7280" font-size="10">Producer â†’ auth-events topic</text>
  <text x="501" y="492" fill="#6b7280" font-size="10">SSL/TLS Â· idempotent producer</text>
  <rect x="500" y="500" width="54" height="10" rx="3" fill="#6c63ff1a"/>
  <text x="527" y="508" text-anchor="middle" fill="#6c63ff" font-size="8" font-weight="600">KAFKAJS</text>

  <!-- Auth Worker -->
  <rect x="734" y="442" width="246" height="68" rx="8" fill="#111318" stroke="#6c63ff40" stroke-width="1" filter="url(#shadow)"/>
  <rect x="734" y="442" width="246" height="2" rx="2" fill="#6c63ff"/>
  <text x="756" y="468" fill="#6c63ff" font-size="18">ğŸ“­</text>
  <text x="785" y="466" fill="white" font-size="13" font-weight="700">Auth Worker</text>
  <text x="739" y="480" fill="#6b7280" font-size="10">Consumer: auth-events group</text>
  <text x="739" y="492" fill="#6b7280" font-size="10">SEND_WELCOME_EMAIL handler</text>
  <rect x="738" y="500" width="60" height="10" rx="3" fill="#6c63ff1a"/>
  <text x="768" y="508" text-anchor="middle" fill="#6c63ff" font-size="8" font-weight="600">CONSUMER</text>

  <!-- Kafka â†’ Worker arrow (purple event) -->
  <line x1="724" y1="476" x2="737" y2="476" stroke="#6c63ff" stroke-width="1.5" marker-end="url(#arrowPurple)" stroke-dasharray="4 2"/>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- LAYER 5: AUTH FLOW STEPS                   -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <text x="20" y="530" fill="#6b7280" font-size="9" letter-spacing="2" font-weight="600">05 â€” SIGNUP â†’ VERIFY â†’ LOGIN â†’ REFRESH FLOW</text>
  <line x1="340" y1="526" x2="980" y2="526" stroke="#2a2d3a" stroke-width="1"/>

  <rect x="20" y="536" width="960" height="132" rx="10" fill="#111318" stroke="#2a2d3a" stroke-width="1"/>

  <!-- Step 1 -->
  <circle cx="68" cy="562" r="12" fill="#00e5a01a" stroke="#00e5a040" stroke-width="1"/>
  <text x="68" y="566" text-anchor="middle" fill="#00e5a0" font-size="10" font-weight="700">1</text>
  <text x="88" y="560" fill="white" font-size="11" font-weight="700">POST /signup</text>
  <text x="88" y="574" fill="#6b7280" font-size="10">Register Â· generate OTP</text>
  <text x="88" y="586" fill="#6b7280" font-size="10">store in Redis Â· send email</text>

  <line x1="200" y1="562" x2="216" y2="562" stroke="#00e5a0" stroke-width="1" marker-end="url(#arrowGreen)"/>

  <!-- Step 2 -->
  <circle cx="232" cy="562" r="12" fill="#00e5a01a" stroke="#00e5a040" stroke-width="1"/>
  <text x="232" y="566" text-anchor="middle" fill="#00e5a0" font-size="10" font-weight="700">2</text>
  <text x="252" y="560" fill="white" font-size="11" font-weight="700">POST /verify</text>
  <text x="252" y="574" fill="#6b7280" font-size="10">Validate OTP vs Redis</text>
  <text x="252" y="586" fill="#6b7280" font-size="10">isVerified=true Â· fire Kafka</text>

  <line x1="370" y1="562" x2="386" y2="562" stroke="#6c63ff" stroke-width="1" marker-end="url(#arrowPurple)" stroke-dasharray="4 2"/>

  <!-- Step 3 -->
  <circle cx="402" cy="562" r="12" fill="#6c63ff1a" stroke="#6c63ff40" stroke-width="1"/>
  <text x="402" y="566" text-anchor="middle" fill="#6c63ff" font-size="10" font-weight="700">3</text>
  <text x="422" y="560" fill="white" font-size="11" font-weight="700">Kafka Event</text>
  <text x="422" y="574" fill="#6b7280" font-size="10">SEND_WELCOME_EMAIL</text>
  <text x="422" y="586" fill="#6b7280" font-size="10">async Â· decoupled</text>

  <line x1="550" y1="562" x2="566" y2="562" stroke="#ffd166" stroke-width="1" marker-end="url(#arrowYellow)"/>

  <!-- Step 4 -->
  <circle cx="582" cy="562" r="12" fill="#ffd1661a" stroke="#ffd16640" stroke-width="1"/>
  <text x="582" y="566" text-anchor="middle" fill="#ffd166" font-size="10" font-weight="700">4</text>
  <text x="602" y="560" fill="white" font-size="11" font-weight="700">POST /login</text>
  <text x="602" y="574" fill="#6b7280" font-size="10">bcrypt compare pw</text>
  <text x="602" y="586" fill="#6b7280" font-size="10">issue JWT pair</text>

  <line x1="716" y1="562" x2="732" y2="562" stroke="#00e5a0" stroke-width="1" marker-end="url(#arrowGreen)"/>

  <!-- Step 5 -->
  <circle cx="748" cy="562" r="12" fill="#00e5a01a" stroke="#00e5a040" stroke-width="1"/>
  <text x="748" y="566" text-anchor="middle" fill="#00e5a0" font-size="10" font-weight="700">5</text>
  <text x="768" y="560" fill="white" font-size="11" font-weight="700">Protect MW</text>
  <text x="768" y="574" fill="#6b7280" font-size="10">Verify Bearer JWT</text>
  <text x="768" y="586" fill="#6b7280" font-size="10">attach req.user</text>

  <line x1="880" y1="562" x2="896" y2="562" stroke="#00e5a0" stroke-width="1" marker-end="url(#arrowGreen)"/>

  <!-- Step 6 -->
  <circle cx="912" cy="562" r="12" fill="#38bdf81a" stroke="#38bdf840" stroke-width="1"/>
  <text x="912" y="566" text-anchor="middle" fill="#38bdf8" font-size="10" font-weight="700">6</text>
  <text x="932" y="560" fill="white" font-size="11" font-weight="700">Refresh</text>
  <text x="932" y="574" fill="#6b7280" font-size="10">Validate + Redis</text>
  <text x="932" y="586" fill="#6b7280" font-size="10">rotate tokens</text>

  <!-- Separator line -->
  <line x1="30" y1="600" x2="970" y2="600" stroke="#2a2d3a" stroke-width="1"/>

  <!-- API ENDPOINTS quick ref -->
  <text x="40" y="618" fill="#6b7280" font-size="10" font-weight="700" letter-spacing="1">API ENDPOINTS</text>

  <!-- Row of method labels -->
  <rect x="40" y="626" width="44" height="16" rx="3" fill="#00e5a01a"/>
  <text x="62" y="637" text-anchor="middle" fill="#00e5a0" font-size="9" font-weight="700">POST</text>
  <text x="91" y="637" fill="#c0c6d8" font-size="10">/signup</text>

  <rect x="158" y="626" width="44" height="16" rx="3" fill="#00e5a01a"/>
  <text x="180" y="637" text-anchor="middle" fill="#00e5a0" font-size="9" font-weight="700">POST</text>
  <text x="209" y="637" fill="#c0c6d8" font-size="10">/verify</text>

  <rect x="274" y="626" width="44" height="16" rx="3" fill="#00e5a01a"/>
  <text x="296" y="637" text-anchor="middle" fill="#00e5a0" font-size="9" font-weight="700">POST</text>
  <text x="325" y="637" fill="#c0c6d8" font-size="10">/login</text>

  <rect x="384" y="626" width="44" height="16" rx="3" fill="#00e5a01a"/>
  <text x="406" y="637" text-anchor="middle" fill="#00e5a0" font-size="9" font-weight="700">POST</text>
  <text x="435" y="637" fill="#c0c6d8" font-size="10">/refresh-token</text>

  <rect x="544" y="626" width="44" height="16" rx="3" fill="#38bdf81a"/>
  <text x="566" y="637" text-anchor="middle" fill="#38bdf8" font-size="9" font-weight="700">GET</text>
  <text x="595" y="637" fill="#c0c6d8" font-size="10">/me Â· /users</text>

  <rect x="664" y="626" width="38" height="16" rx="3" fill="#ffd1661a"/>
  <text x="683" y="637" text-anchor="middle" fill="#ffd166" font-size="9" font-weight="700">PUT</text>
  <text x="709" y="637" fill="#c0c6d8" font-size="10">/users/:id</text>

  <rect x="772" y="626" width="46" height="16" rx="3" fill="#ff6b6b1a"/>
  <text x="795" y="637" text-anchor="middle" fill="#ff6b6b" font-size="9" font-weight="700">DELETE</text>
  <text x="825" y="637" fill="#c0c6d8" font-size="10">/users/:id</text>

  <!-- LEGEND -->
  <line x1="30" y1="656" x2="970" y2="656" stroke="#2a2d3a" stroke-width="0.5"/>
  <text x="40" y="675" fill="#6b7280" font-size="9">LEGEND:</text>
  <line x1="90" y1="671" x2="126" y2="671" stroke="#00e5a0" stroke-width="1.5" marker-end="url(#arrowGreen)"/>
  <text x="132" y="675" fill="#6b7280" font-size="9">HTTP / REST</text>
  <line x1="210" y1="671" x2="246" y2="671" stroke="#ffd166" stroke-width="1.5" stroke-dasharray="4 2" marker-end="url(#arrowYellow)"/>
  <text x="252" y="675" fill="#6b7280" font-size="9">Cache (Redis)</text>
  <line x1="340" y1="671" x2="376" y2="671" stroke="#6c63ff" stroke-width="1.5" stroke-dasharray="4 2" marker-end="url(#arrowPurple)"/>
  <text x="382" y="675" fill="#6b7280" font-size="9">Kafka Event</text>

  <!-- BUILT WITH footer -->
  <text x="980" y="800" text-anchor="end" fill="#2a2d3a" font-size="10" font-family="monospace">User Authentication System v1.0</text>
</svg>